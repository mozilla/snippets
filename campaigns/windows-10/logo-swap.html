<style>

  div.switch-{{ snippet_id }}#brandLogo {
      background-size: {{ width|default(192, true) }}px {{ height ~ 'px' if height else 'auto' }};   
  }
  
  a.logo-link-{{ snippet_id }} {
      display: inline-block;
  }
  
  .switch-{{ snippet_id }}#brandLogo {
      height: {{ height|default(192, true) }}px;
      width: {{ width|default(192, true) }}px;
  }

  .button-flat-{{ snippet_id}} {
    display: inline-block;
    border-radius: 5px;
    transition: all 0.25s linear 0s;
    font-family: "Open Sans",sans-serif;
    text-align: center;
    padding: 9px 40px;
    margin-bottom: 20px;
    color: #FFF;
    font-size: 0.875rem;
    border: 2px solid #0d99d6;
    cursor: pointer;
    background: #0d99d6 none repeat scroll 0% 0%;
    }

  .button-flat-{{ snippet_id}}::after {
    content: " \00bb";
    white-space: nowrap;
  }

  .button-flat-{{ snippet_id}}:hover {
    background: #F2F2F2 none repeat scroll 0% 0%;
    color: #0d99d6;
  }

  .text-not-default-{{ snippet_id }} {
    padding: 0px 45px;
    padding-bottom: 20px;
    line-height: 17px;
  }

  #xbutton-{{ snippet_id }} {
    float: right;
    z-index: 10;
    visibility: hidden;
    height: 28px;
    width: 28px;
    padding-right: 7px;
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAeFBMVEUAAAAAAAAAAAABAQEAAAAAAAAAAAAAAAAAAAAAAADDw8OQkJAAAAAAAAAAAAAAAAD9/f38/Pz6+vr5+fnt7e3i4uLd3d3Z2dmgoKBdXV0mJibv7++amprNzc2amprv7+////9zc3OwsLD29vaPj4+xsbHCwsLBwcHrzmRyAAAAIHRSTlMABAg9HhEMNxkir38xLCkV/Pr39OHTzceOYUrliLuJ5ik+KlgAAAGhSURBVEjHnZbrdoIwDIAXWii3UuV+0wV0+v5vOEBH2ajg8v3y6PlO2pgm+TAAYD0B+HgDsBxbuXzCVbZj7VgAju16USjYhAgjz7WdrVjgKC5FHfh5kxwOSZP7QS0kVw68PJLNJQuKIy44FgGT3LbAHMKNWJviirRlkWsKNIQIqwyNZFU4BFobnihjfEFcCm92tMF83MBnfxwYjBNuchocWN6cCx938AVf5MBywxJ3KUPX0seKqnhfiavIhvlYLMM3yNjP0UDJFmcuN/zF7aI/t1I9lCFIqo1r1y+Nr+6qnXQI87iJDJZGNzra6JZOIG2Y0iWK+bt7N9JrY+Q+/1yIKWmOVy9qt3862lgGPdaeM2U4QDQ52tAEY55BhT4aHS1r/FDBeJUcTY7JwHy8jMVZgybHZGDD+KQkuHbMBiZP5YBrx2zggaCQDka5PiHJhL9yq2B6c8FslmVvKsud4u8Nxb/3xPr1E9t9yP3qIf+vXZylAkJTIrQ+QoMltHHCsCCMJMLgo49XPcTPpiF+1kOcsCrsLSSfeiGhrj305Yqwwn0Dwi/I5rQKpwMAAAAASUVORK5CYII=");
    background-repeat: no-repeat;
    background-size: 28px 28px;
  }
  #xbutton-{{ snippet_id }}:hover {
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAe1BMVEUAAAAAAAAAAAAAAAABAQEAAAAAAAAAAAAAAAABAQEAAACQkJAAAADDw8P9/f38/Pz6+vr5+fni4uLZ2dmgoKCampomJibv7+/d3d3ExMRcXFzt7e3t7e3Nzc0AAABeXl7c3Nzv7+/////DOzLdkYz78/LlqaXPYlveko1iPwM8AAAAInRSTlMACwceOhcRBCo+NH8ir/z69/TTx46ISuXNsGHh4LskYszmffUm0QAAAbBJREFUSMelluuSgjAMRrdtegW84/22AXXf/wlXcNzAGEC755fjeCYfmDb5YrBWihpp7dcbWCmM1qpGa3PX3vh96kIAfwdCcOmAJYVWDpZJdl5NR6Pp6pwlS3BKC9lVQhjlfDIfY4PxPPFOGWE7SjjI9/jCPgfHFpJGhe0MWWbboIx8NVJYTLCDyQLSp0PGETLsIYPj06EaB+zl0K5jhYINDrAB1XhvQocFDrIIWlAst50MK5OtM5JizfANZn/RpHY5fX+5YovrhT7nTj/KCOX3ZNyKsmn8FDdydl6JOpdxSdMoKoeMoukkztg6F8wpRlFRklFBUedQJxPpstG7JTm10S46XqaCcjEOGe1kVocMWYdkIgvaVo+yRs7hDFxXDyMUrJBzOANXoMRd8VNkHTKIqX8oI2QdMohRjBIVLOLxI15yxF/Z1zAl3zC9bVlybTnQ/CXT/ENHrGSO2OMg7zoPcvlykCOui88upXsR+9nVd3JGRlywEdd4xLCIGEnRg4/G66lrvJ6q8coPcZ/vuCHuaYjHrQr8QrKuF5Lv9YYWkqG1Bx5rD9Da87/lKmKF+wUdVNNtsJwP7gAAAABJRU5ErkJggg==");
  }
  #xbutton-{{ snippet_id }}:active {
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAe1BMVEUAAAAAAAAAAAAAAAABAQEAAAABAQEAAAAAAAAAAAD9/f3Dw8MAAAAAAACRkZH6+vr5+fnv7+/i4uLd3d3Z2dmgoKBdXV0mJiYAAAAAAACPj4/t7e3t7e2ampoAAACamprOzs7MzMyYmJj///8QEBB5eXnw8PCWlpZAQEB2Ec74AAAAI3RSTlMABgseOio+GRA0+68iEn/39OXTzceOYUoWFX/h4Igjiby5hsu+k6AAAAGoSURBVEjHnZbpYoIwEISbZEMIl8oNam27eLz/E9YY22DdgmR+efAxGxJ2540SY/wmxog/ycvDVombVBvOY4ynKpFaQ3AVaC0TlXI2CXRCQtPHxWYdRetNEWcNSNFZiHYQMsjKCEeKyiyQwjiRhJKw3+GTdl8gFcWwUOg6R1J5rUXInokEqhX+o1UFiWXGxDvEOKEY3i0z9vjESX08+jAurMe0j+CO4UpXOKtKK/5rksp6NY+sapmyHxMBOb6gHAS/m3Ry734/nfFB55P7vJcdu5sEO0dchuOYOA4Xx2wDwe8r6cfEYBhHDGMms6thCkpXxmB0dISRK7UEZRCeNNHotpYhvhhFTWIqC01dBEMQiL0Mr3W1OkaCIQmMdcvMUgqkGIrAwiyGC9ggxVAEbkBwsytrJBiSwHVgkQgJhiQw8kG8CvNYvsdD9thKc2Cy1w9MJkOPY+l3+Fkqs4WvmNmZ7YIXeVm7OMiOLWxKxsSj9Xk0WI827jEsPEaSx+DzHq9uiAeHLTHED4Eb4lRU6P9Ghd5GhelAkhGBZDb2gI09QMQer3DlEeG+AWkO2NrlPO+kAAAAAElFTkSuQmCC");
  }
  #fx-default-{{ snippet_id }}:hover > #xbutton-{{ snippet_id }} {
    visibility: visible;
  }

  #block-snippet-overlay-{{ snippet_id }} {
    background-color: #eaeaea;
    position: absolute;
    height: 100%;
    width: 100%;
    left: 0px;
    top: -5px;
    padding-top: 5px;
    padding-bottom: 5px;
    z-index: -10;
    border-radius: 15px;
    visibility: hidden;
  }

  #xbutton-{{ snippet_id }}:hover + #block-snippet-overlay-{{ snippet_id }} {
    visibility: visible;
  }
</style>

<div id="fx-default-{{ snippet_id }}" class="snippet">

  <div class="block-snippet-button" id="xbutton-{{ snippet_id }}">
  </div>
  <div id="block-snippet-overlay-{{ snippet_id }}">
  </div>

  <div id="content-default-{{ snippet_id }}" style="display:none;">
    <a href="#" class="launch-default"><img class="icon" id="icon-{{ snippet_id }}"/></a>
    <p id="text-default-{{ snippet_id }}" style="display:none;">{{ text_default|safe }}</p>
    <p id="text-success-{{ snippet_id }}" style="display:none;">{{ text_default_success|safe }}</p>
  </div>
  <div id="content-not-default-{{ snippet_id }}" style="display:none;text-align: center;">
    <div id="text-not-default-{{ snippet_id }}" class="text-not-default-{{ snippet_id }}">{{ text_not_default|safe }}</div>
    <a href="#" class="launch-default button-flat-{{ snippet_id}}">{{ cta_text|safe }}</a>
  </div>

  <script type="text/javascript">
   //<![CDATA[

   (function() {
       var snippet = document.getElementById('fx-default-{{ snippet_id }}');
       var newLogo = '{{ replacement_logo }}';
       snippet.addEventListener('show_snippet', function () {

          var brandLogo = document.getElementById('brandLogo');
          if (brandLogo.src !== undefined) {
              brandLogo.src = newLogo;
          } else {
              brandLogo.style.backgroundImage = 'url(' + newLogo + ')';
          }
          brandLogo.className += ' switch-{{ snippet_id }}';

           var buttons = snippet.querySelectorAll('.launch-default');
           var snippet_content_default = document.getElementById('content-default-{{ snippet_id }}');
           var snippet_content_not_default = document.getElementById('content-not-default-{{ snippet_id }}');
           var snippet_text_default = document.getElementById('text-default-{{ snippet_id }}');
           var snippet_text_success = document.getElementById('text-success-{{ snippet_id }}');
           var snippet_icon = document.getElementById('icon-{{ snippet_id }}');

           var poll_retry = 0;
           var check_default_timeout = undefined;
           var is_firefox_default = undefined;
           var cta_clicked = false;

           isDefault(function yesDefault () {
               sendMetric('impression-is-default');
               showDefaultContent();
               is_firefox_default = true;
           }, function noDefault () {
               sendMetric('impression-is-not-default');
               showNonDefaultContent();
               is_firefox_default = false;
           });

           var check_default_timeout = window.setInterval(function () {
               if (poll_retry > 500) {
                   clearInterval(check_default_timeout);
               }
               poll_retry++;
               isDefault(function yesDefault () {
                   //Default has switched while the snippet is opened
                   if (is_firefox_default !== true) {
                       showSuccessContent();
                       is_firefox_default = true;
                       if (cta_clicked === true) {
                           sendMetric('conversion-is-default-changed-after-click');
                       } else {
                           sendMetric('conversion-is-default-changed-without-click');
                       }
                       clearInterval(check_default_timeout);
                   }
               }, function noDefault () {
                   if (is_firefox_default !== false) {
                       showNonDefaultContent();
                       is_firefox_default = false;
                   }
               });
           }, 1000);

           function showDefaultContent () {
               snippet_text_default.style.display = 'block';
               snippet_text_success.style.display = 'none';
               snippet_content_default.style.display = 'block';
               snippet_content_not_default.style.display = 'none';
               snippet_icon.src = '{{ icon }}';

               for (var i=0, k=buttons.length; i<k; i++) {
                   buttons[i].addEventListener('click', function (e) {
                       e.preventDefault();
                       sendMetric('conversion-is-default-click', function () {
                           window.location = '{{ url_default|safe }}';
                       });
                   }, false);
               }
           }

           function showSuccessContent () {
               snippet_text_default.style.display = 'none';
               snippet_text_success.style.display = 'block';
               snippet_content_default.style.display = 'block';
               snippet_content_not_default.style.display = 'none';
               snippet_icon.src = '{{ icon }}';

               for (var i=0; i < buttons.length; i++) {
                   buttons[i].addEventListener('click', function (e) {
                       e.preventDefault();
                       sendMetric('conversion-is-default-click', function () {
                           window.location = '{{ url_default|safe }}';
                       });
                   }, false);
               }
           }

           function showNonDefaultContent () {
               snippet_content_default.style.display = 'none';
               snippet_content_not_default.style.display = 'block';

               for (var i=0; i < buttons.length; i++) {
                   buttons[i].addEventListener('click', function (e) {
                       e.preventDefault();
                       Mozilla.UITour.setConfiguration('defaultBrowser');
                       sendMetric('conversion-is-not-default-click');
                       cta_clicked = true;
                   }, false);
               }
           }

           function isDefault (yesDefault, noDefault) {
               Mozilla.UITour.getConfiguration('appinfo', function(config) {
                if (config && config.defaultBrowser === false) {
                  noDefault();
                } else {
                  yesDefault();
                }
               });
           }

       }, false);
   })();

   //]]>
  </script>
</div>
